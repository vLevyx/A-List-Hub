(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[519],{4714:function(e,t,r){Promise.resolve().then(r.bind(r,1953))},9376:function(e,t,r){"use strict";var i=r(5475);r.o(i,"usePathname")&&r.d(t,{usePathname:function(){return i.usePathname}}),r.o(i,"useRouter")&&r.d(t,{useRouter:function(){return i.useRouter}})},5523:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouterContext",{enumerable:!0,get:function(){return i}});let i=r(7043)._(r(2265)).default.createContext(null)},1953:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var i=r(7437),n=r(2265),s=r(2495),a=r(3145);let l=[{id:"27429034",label:"Island 1"},{id:"28035581",label:"Island 2"},{id:"30844316",label:"Island 3"},{id:"31614162",label:"Island 4"},{id:"29675841",label:"Island 5"},{id:"30871980",label:"Island 6"},{id:"33676045",label:"Island 7"}],c={us:"United States",ca:"Canada",gb:"United Kingdom",de:"Germany",fr:"France",nl:"Netherlands",au:"Australia",ru:"Russia",se:"Sweden",no:"Norway",fi:"Finland",es:"Spain",it:"Italy",br:"Brazil",un:"Unknown"};function d(){(0,s.j)();let[e,t]=(0,n.useState)({}),[r,d]=(0,n.useState)("--"),[o,u]=(0,n.useState)(!0),f=(0,n.useRef)(null),v={totalServers:l.length,onlineServers:Object.values(e).filter(e=>(null==e?void 0:e.status)==="online").length,totalPlayers:Object.values(e).reduce((e,t)=>e+((null==t?void 0:t.players)||0),0),avgCapacity:Object.values(e).length>0?Object.values(e).reduce((e,t)=>e+((null==t?void 0:t.players)||0)/128*100,0)/Object.values(e).length:0},m=e=>e<=25?"bg-gradient-to-r from-[#00c6ff] to-[#0072ff]":e<=50?"bg-gradient-to-r from-[#0072ff] to-[#00c6ff]":e<=75?"bg-gradient-to-r from-[#ff6b35] to-[#f7931e]":"bg-gradient-to-r from-[#ff4757] to-[#ff3838]",h=async e=>{try{let r=await fetch("https://api.battlemetrics.com/servers/".concat(e)),i=(await r.json()).data.attributes;t(t=>{var r;return{...t,[e]:{name:i.name,status:i.status,players:i.players,maxPlayers:i.maxPlayers,country:i.country,region:null===(r=i.details)||void 0===r?void 0:r.regionName}}})}catch(e){}},x=async()=>{u(!0);let e=l.map(e=>{let{id:t}=e;return h(t)});await Promise.allSettled(e),d(new Date().toLocaleTimeString()),u(!1)};return(0,n.useEffect)(()=>(x(),f.current=setInterval(x,6e4),()=>{f.current&&clearInterval(f.current)}),[]),(0,i.jsxs)("div",{className:"min-h-screen bg-[#121212] text-white px-4 py-6 relative",children:[(0,i.jsx)("div",{className:"fixed inset-0 pointer-events-none z-0",children:(0,i.jsx)("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_25%_25%,rgba(0,198,255,0.03)_0%,transparent_50%),radial-gradient(circle_at_75%_75%,rgba(0,114,255,0.03)_0%,transparent_50%)]"})}),(0,i.jsxs)("div",{className:"max-w-6xl mx-auto relative z-10",children:[(0,i.jsxs)("div",{className:"text-center mb-8",children:[(0,i.jsx)("h1",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-[#00c6ff] to-[#0072ff] inline-block text-transparent bg-clip-text mb-1",children:"ELAN Life"}),(0,i.jsx)("p",{className:"text-[#888888] text-lg",children:"Live Server Status Dashboard"})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[(0,i.jsxs)("div",{className:"bg-white/[0.02] backdrop-blur-xl border border-white/[0.08] rounded-xl p-4 text-center transition-all hover:border-[#00c6ff]/30",children:[(0,i.jsx)("div",{className:"text-3xl font-bold text-[#00c6ff] mb-1",children:v.totalServers}),(0,i.jsx)("div",{className:"text-xs text-[#888888] uppercase tracking-wider",children:"Total Servers"})]}),(0,i.jsxs)("div",{className:"bg-white/[0.02] backdrop-blur-xl border border-white/[0.08] rounded-xl p-4 text-center transition-all hover:border-[#00c6ff]/30",children:[(0,i.jsx)("div",{className:"text-3xl font-bold text-[#00c6ff] mb-1",children:o?"--":v.onlineServers}),(0,i.jsx)("div",{className:"text-xs text-[#888888] uppercase tracking-wider",children:"Online"})]}),(0,i.jsxs)("div",{className:"bg-white/[0.02] backdrop-blur-xl border border-white/[0.08] rounded-xl p-4 text-center transition-all hover:border-[#00c6ff]/30",children:[(0,i.jsx)("div",{className:"text-3xl font-bold text-[#00c6ff] mb-1",children:o?"--":v.totalPlayers}),(0,i.jsx)("div",{className:"text-xs text-[#888888] uppercase tracking-wider",children:"Total Players"})]}),(0,i.jsxs)("div",{className:"bg-white/[0.02] backdrop-blur-xl border border-white/[0.08] rounded-xl p-4 text-center transition-all hover:border-[#00c6ff]/30",children:[(0,i.jsx)("div",{className:"text-3xl font-bold text-[#00c6ff] mb-1",children:o?"--":"".concat(Math.round(v.avgCapacity),"%")}),(0,i.jsx)("div",{className:"text-xs text-[#888888] uppercase tracking-wider",children:"Avg Capacity"})]})]}),(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:l.map(t=>{var r;let{id:n,label:s}=t,l=e[n],d=(null==l?void 0:l.status)==="online",u=(null==l?void 0:l.players)||0,f=(null==l?void 0:l.maxPlayers)||128,v=Math.min(u/f*100,100),h=(null==l?void 0:null===(r=l.country)||void 0===r?void 0:r.toLowerCase())||"un",x=(null==l?void 0:l.region)||c[h]||"Unknown";return(0,i.jsxs)("div",{className:"bg-white/[0.02] backdrop-blur-xl border border-white/[0.08] rounded-xl p-6 transition-all hover:border-[#00c6ff]/20",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-lg font-semibold text-white mb-1",children:(null==l?void 0:l.name)||"Loading..."}),(0,i.jsx)("div",{className:"text-sm text-[#666666]",children:s})]}),(0,i.jsxs)("div",{className:"px-3 py-1.5 rounded-md text-xs font-semibold uppercase tracking-wider flex items-center gap-1.5 ".concat(d?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-gray-500/10 text-gray-400 border border-gray-500/20"),children:[(0,i.jsx)("span",{className:"w-1 h-1 rounded-full bg-current"}),d?"Online":"Offline"]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,i.jsx)("div",{className:"text-xs text-[#888888] uppercase tracking-wider",children:"Players"}),(0,i.jsx)("div",{className:"text-white font-semibold",children:o?"--/--":"".concat(u,"/").concat(f)})]}),(0,i.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,i.jsx)("div",{className:"text-xs text-[#888888] uppercase tracking-wider",children:"Location"}),(0,i.jsxs)("div",{className:"text-white font-semibold flex items-center gap-2",children:[x,h&&(0,i.jsx)(a.default,{src:"https://flagcdn.com/h20/".concat(h,".png"),alt:h,width:16,height:12,className:"rounded-sm"})]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,i.jsx)("span",{className:"text-sm text-[#888888]",children:o?"--":"".concat(Math.round(v),"% full")})}),(0,i.jsx)("div",{className:"h-1.5 bg-white/5 rounded-full overflow-hidden",children:(0,i.jsx)("div",{className:"h-full rounded-full transition-all duration-500 ".concat(m(v)),style:{width:"".concat(o?0:v,"%")}})})]})]},n)})}),(0,i.jsxs)("div",{className:"fixed bottom-4 right-4 bg-black/40 backdrop-blur-md px-3 py-2 rounded-lg text-xs text-[#888888] border border-white/5 md:static md:mt-8 md:text-center",children:["Last updated: ",(0,i.jsx)("span",{children:r})]})]})]})}},4603:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return d},a:function(){return c}});var i=r(7437),n=r(2265),s=r(8933),a=r(3448);let l=(0,n.createContext)({user:null,session:null,loading:!0,hasAccess:!1,isTrialActive:!1,signInWithDiscord:async()=>{},signOut:async()=>{},refreshUserData:async()=>{}}),c=()=>{let e=(0,n.useContext)(l);if(!e)throw Error("useAuth must be used within an AuthProvider");return e};function d(e){let{children:t}=e,[r,c]=(0,n.useState)({user:null,session:null,loading:!0,hasAccess:!1,isTrialActive:!1}),d=(0,s.e)(),o=async e=>{let t=(0,a.Xl)(e);if(!t)return{hasAccess:!1,isTrialActive:!1};try{let{data:e,error:r}=await d.from("users").select("revoked, hub_trial, trial_expiration").eq("discord_id",t).single();if(r||!e)return{hasAccess:!1,isTrialActive:!1};let i=(0,a.$1)(e);return{hasAccess:(0,a.Bi)(e),isTrialActive:i}}catch(e){return{hasAccess:!1,isTrialActive:!1}}},u=async()=>{if(!r.user)return;let{hasAccess:e,isTrialActive:t}=await o(r.user);c(r=>({...r,hasAccess:e,isTrialActive:t}))},f=async()=>{try{let{error:e}=await d.auth.signInWithOAuth({provider:"discord",options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}});if(e)throw e}catch(e){}},v=async()=>{try{let{error:e}=await d.auth.signOut();if(e)throw e;c({user:null,session:null,loading:!1,hasAccess:!1,isTrialActive:!1})}catch(e){}};return(0,n.useEffect)(()=>{(async()=>{try{let{data:{session:t},error:r}=await d.auth.getSession();if(r){c(e=>({...e,loading:!1}));return}if(null==t?void 0:t.user){var e;let{hasAccess:r,isTrialActive:i}=await o(t.user);c({user:t.user,session:t,loading:!1,hasAccess:r,isTrialActive:i});let n=(0,a.Xl)(t.user),s=(null===(e=t.user.user_metadata)||void 0===e?void 0:e.full_name)||"Discord User";n&&await d.rpc("upsert_user_login",{target_discord_id:n,user_name:s})}else c(e=>({...e,loading:!1}))}catch(e){c(e=>({...e,loading:!1}))}})();let{data:{subscription:e}}=d.auth.onAuthStateChange(async(e,t)=>{if("SIGNED_IN"===e&&(null==t?void 0:t.user)){let{hasAccess:e,isTrialActive:r}=await o(t.user);c({user:t.user,session:t,loading:!1,hasAccess:e,isTrialActive:r})}else"SIGNED_OUT"===e&&c({user:null,session:null,loading:!1,hasAccess:!1,isTrialActive:!1})});return()=>e.unsubscribe()},[]),(0,n.useEffect)(()=>{if(!r.user)return;let e=(0,a.Xl)(r.user);if(!e)return;let t=d.channel("user-access-changes").on("postgres_changes",{event:"UPDATE",schema:"public",table:"users",filter:"discord_id=eq.".concat(e)},async e=>{await u()}).subscribe();return()=>{d.removeChannel(t)}},[r.user]),(0,i.jsx)(l.Provider,{value:{...r,signInWithDiscord:f,signOut:v,refreshUserData:u},children:t})}},2495:function(e,t,r){"use strict";r.d(t,{j:function(){return c}});var i=r(2265),n=r(9376),s=r(8933),a=r(4603),l=r(3448);function c(){let{user:e}=(0,a.a)(),t=(0,n.usePathname)(),r=(0,s.e)(),c=(0,i.useRef)(null),d=(0,i.useRef)(null);(0,i.useEffect)(()=>{if(!e)return;let i=(0,l.Xl)(e),n=(0,l.Ms)(e);if(!i)return;let s=async()=>{if(c.current)try{await r.from("page_sessions").update({exit_time:new Date().toISOString(),is_active:!1}).eq("id",c.current)}catch(e){}},a=async()=>{if(c.current&&"visible"===document.visibilityState)try{await r.from("page_sessions").update({is_active:!0}).eq("id",c.current)}catch(e){}};(async e=>{try{c.current&&d.current&&await r.from("page_sessions").update({exit_time:new Date().toISOString(),is_active:!1}).eq("id",c.current);let{data:t,error:s}=await r.from("page_sessions").insert([{discord_id:i,username:n,page_path:e,enter_time:new Date().toISOString(),is_active:!0}]).select("id").single();s||(c.current=(null==t?void 0:t.id)||null,d.current=e)}catch(e){}})(t);let o=()=>{"hidden"===document.visibilityState?c.current&&Promise.resolve(r.from("page_sessions").update({is_active:!1}).eq("id",c.current)).then(()=>{}).catch(console.error):"visible"===document.visibilityState&&a()},u=()=>{s()};document.addEventListener("visibilitychange",o),window.addEventListener("beforeunload",u);let f=setInterval(a,3e4);return()=>{document.removeEventListener("visibilitychange",o),window.removeEventListener("beforeunload",u),clearInterval(f),s()}},[e,t]),(0,i.useEffect)(()=>{if(!e||!c.current)return;let i=(0,l.Xl)(e),n=(0,l.Ms)(e);if(!i)return;let s=async()=>{c.current&&await r.from("page_sessions").update({exit_time:new Date().toISOString(),is_active:!1}).eq("id",c.current);let{data:e,error:s}=await r.from("page_sessions").insert([{discord_id:i,username:n,page_path:t,enter_time:new Date().toISOString(),is_active:!0}]).select("id").single();!s&&e&&(c.current=e.id,d.current=t)};d.current!==t&&s()},[t,e])}},8933:function(e,t,r){"use strict";r.d(t,{e:function(){return n}});var i=r(9924);let n=()=>(0,i.AY)("https://dsexkdjxmhgqahrlkvax.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRzZXhrZGp4bWhncWFocmxrdmF4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg0ODAxNTAsImV4cCI6MjA2NDA1NjE1MH0.RW_ROpcNUNZaK9xGH2OFwHBSmFsGrLj-yi3LWCPBCvA")},3448:function(e,t,r){"use strict";r.d(t,{$1:function(){return d},Bi:function(){return o},E$:function(){return c},Ms:function(){return l},Xl:function(){return a},cn:function(){return s}});var i=r(1994),n=r(3335);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,i.W)(t))}function a(e){var t,r;return(null==e?void 0:null===(t=e.user_metadata)||void 0===t?void 0:t.provider_id)||(null==e?void 0:null===(r=e.user_metadata)||void 0===r?void 0:r.sub)||null}function l(e){var t,r,i;return(null==e?void 0:null===(t=e.user_metadata)||void 0===t?void 0:t.full_name)||(null==e?void 0:null===(r=e.user_metadata)||void 0===r?void 0:r.name)||(null==e?void 0:null===(i=e.user_metadata)||void 0===i?void 0:i.user_name)||"Discord User"}function c(e){var t;return(null==e?void 0:null===(t=e.user_metadata)||void 0===t?void 0:t.avatar_url)||"https://cdn.discordapp.com/embed/avatars/0.png"}function d(e){if(!(null==e?void 0:e.hub_trial)||!(null==e?void 0:e.trial_expiration))return!1;let t=new Date;return new Date(e.trial_expiration)>t}function o(e){return!!e&&(!1===e.revoked||d(e))}}},function(e){e.O(0,[454,924,145,971,117,744],function(){return e(e.s=4714)}),_N_E=e.O()}]);