(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{2020:function(e,t,s){Promise.resolve().then(s.bind(s,6683))},7648:function(e,t,s){"use strict";s.d(t,{default:function(){return i.a}});var r=s(2972),i=s.n(r)},9376:function(e,t,s){"use strict";var r=s(5475);s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},6683:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var r=s(7437),i=s(2265),l=s(2495),a=s(4603),n=s(8933),d=s(7648),c=s(3448);let o=e=>{let{children:t,className:s=""}=e;return(0,r.jsx)("div",{className:"inline-flex h-12 items-center justify-center rounded-lg bg-white/5 p-1 text-white/70 ".concat(s),children:t})},u=e=>{let{children:t,value:s,onClick:i,active:l,className:a=""}=e;return(0,r.jsx)("button",{onClick:()=>i(s),className:"inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-2.5 text-sm font-medium transition-all focus-visible:outline-none disabled:pointer-events-none disabled:opacity-50 ".concat(l?"bg-[#00c6ff] text-black shadow-sm":"hover:bg-white/10"," ").concat(a),children:t})},h=e=>{let{children:t,value:s,activeValue:i,className:l=""}=e;return(0,r.jsx)("div",{className:"mt-2 ".concat(s===i?"block":"hidden"," ").concat(l),children:t})},x=e=>{let{message:t,type:s,onClose:l}=e;return(0,i.useEffect)(()=>{let e=setTimeout(()=>{l()},5e3);return()=>clearTimeout(e)},[l]),(0,r.jsx)("div",{className:"fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-md border-l-4 ".concat("success"===s?"bg-green-900/80 border-green-500 text-green-100":"error"===s?"bg-red-900/80 border-red-500 text-red-100":"bg-blue-900/80 border-blue-500 text-blue-100"," backdrop-blur-md"),children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"flex-1",children:t}),(0,r.jsx)("button",{onClick:l,className:"ml-4 text-white/70 hover:text-white",children:"\xd7"})]})})};function m(){var e,t;(0,l.j)();let{user:s,loading:m}=(0,a.a)(),f=(0,n.e)(),[b,p]=(0,i.useState)("users"),[g,w]=(0,i.useState)([]),[v,j]=(0,i.useState)([]),[N,_]=(0,i.useState)(new Set),[y,k]=(0,i.useState)(null),[C,S]=(0,i.useState)(""),[D,T]=(0,i.useState)(!0),[A,U]=(0,i.useState)(new Set),[I,L]=(0,i.useState)(!1),[E,O]=(0,i.useState)(!1),[P,z]=(0,i.useState)("all"),[F,R]=(0,i.useState)("all"),[q,M]=(0,i.useState)("all"),[W,B]=(0,i.useState)("all"),[X,J]=(0,i.useState)("last_login"),[G,V]=(0,i.useState)(null),[Z,H]=(0,i.useState)([]),[Y,K]=(0,i.useState)([]),[Q,$]=(0,i.useState)([]),[ee,et]=(0,i.useState)({}),[es,er]=(0,i.useState)(""),[ei,el]=(0,i.useState)(0),[ea,en]=(0,i.useState)("time"),[ed,ec]=(0,i.useState)(15),[eo,eu]=(0,i.useState)(0),[eh,ex]=(0,i.useState)(15),[em,ef]=(0,i.useState)(""),[eb,ep]=(0,i.useState)(""),[eg,ew]=(0,i.useState)(""),[ev,ej]=(0,i.useState)(""),eN=["154388953053659137","344637470908088322","796587763851198474","492053410967846933","487476487386038292"],e_=(0,i.useCallback)(()=>{if(!s)return!1;let e=(0,c.Xl)(s);return!!e&&eN.includes(e)},[s,eN]);(0,i.useEffect)(()=>{m||s&&e_()||(window.location.href="/")},[m,s,e_]),(0,i.useEffect)(()=>(!m&&s&&e_()&&(ek(),eC(),eS(),ey()),()=>{let e=f.channel("admin-changes");f.removeChannel(e)}),[m,s,e_]);let ey=(0,i.useCallback)(()=>{let e=f.channel("admin-changes");e.on("postgres_changes",{event:"*",schema:"public",table:"users"},e=>{ek()}),e.on("postgres_changes",{event:"*",schema:"public",table:"admin_logs"},e=>{eC()}),e.on("postgres_changes",{event:"*",schema:"public",table:"page_sessions"},e=>{eS()}),e.subscribe()},[f]),ek=(0,i.useCallback)(async()=>{try{T(!0);let{data:e,error:t}=await f.from("users").select("*").order("created_at",{ascending:!1});if(t)throw t;w(e||[]),eA(e||[]),eD(e||[])}catch(e){eU("Failed to load users","error")}finally{T(!1)}},[f]),eC=(0,i.useCallback)(async()=>{try{let{data:e,error:t}=await f.from("admin_logs").select("*").order("created_at",{ascending:!1}).range(eo*eh,(eo+1)*eh-1);if(t)throw t;H(e||[])}catch(e){}},[f,eo,eh]),eS=(0,i.useCallback)(async()=>{try{let{data:e,error:t}=await f.from("page_sessions").select("page_path, time_spent_seconds, username").not("time_spent_seconds","is",null);if(t)throw t;let s=e||[];$(s);let r={};s.forEach(e=>{e.username&&(r[e.username]||(r[e.username]={}),r[e.username][e.page_path]||(r[e.username][e.page_path]=[]),e.time_spent_seconds&&r[e.username][e.page_path].push(e.time_spent_seconds))}),et(r)}catch(e){}},[f]),eD=(0,i.useCallback)(async e=>{try{let t=e.filter(e=>{if(!e.last_login)return!1;let t=new Date(e.last_login),s=new Date(Date.now()-3e5);return t>s}),s=new Set(t.map(e=>e.discord_id));U(s)}catch(e){}},[]),eT=(0,i.useCallback)(async e=>{try{let{data:t,error:s}=await f.from("user_blueprints").select("blueprint_name").eq("discord_id",e);if(s)throw s;K((null==t?void 0:t.map(e=>e.blueprint_name))||[])}catch(e){K([])}},[f]),eA=(0,i.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=[...e];if(C){let e=C.toLowerCase();t=t.filter(t=>t.discord_id.toLowerCase().includes(e)||t.username&&t.username.toLowerCase().includes(e))}if("all"!==P)switch(P){case"whitelisted":t=t.filter(e=>!e.revoked);break;case"revoked":t=t.filter(e=>e.revoked);break;case"trial":t=t.filter(e=>e.hub_trial&&e.trial_expiration&&new Date(e.trial_expiration)>new Date)}if("all"!==F){let e=new Date;switch(F){case"active_24h":t=t.filter(t=>t.last_login&&new Date(t.last_login)>new Date(e.getTime()-864e5));break;case"active_7d":t=t.filter(t=>t.last_login&&new Date(t.last_login)>new Date(e.getTime()-6048e5));break;case"active_30d":t=t.filter(t=>t.last_login&&new Date(t.last_login)>new Date(e.getTime()-2592e6));break;case"never_logged":t=t.filter(e=>!e.last_login)}}if("all"!==q)switch(q){case"admin":t=t.filter(e=>eN.includes(e.discord_id));break;case"regular":t=t.filter(e=>!eN.includes(e.discord_id)&&!e.hub_trial);break;case"trial":t=t.filter(e=>e.hub_trial)}if("all"!==W){let e;let s=new Date;switch(W){case"today":e=new Date(s.getFullYear(),s.getMonth(),s.getDate());break;case"week":e=new Date(s.getTime()-6048e5);break;case"month":e=new Date(s.getTime()-2592e6);break;case"quarter":e=new Date(s.getTime()-7776e6);break;default:e=new Date(0)}t=t.filter(t=>t.created_at&&new Date(t.created_at)>=e)}t.sort((e,t)=>{switch(X){case"username":return(e.username||"").localeCompare(t.username||"");case"login_count":return(t.login_count||0)-(e.login_count||0);case"created_at":return new Date(t.created_at).getTime()-new Date(e.created_at).getTime();case"trial_expiration":let s=e.trial_expiration?new Date(e.trial_expiration).getTime():0;return(t.trial_expiration?new Date(t.trial_expiration).getTime():0)-s;default:let r=e.last_login?new Date(e.last_login).getTime():0;return(t.last_login?new Date(t.last_login).getTime():0)-r}}),j(t)},[g,C,P,F,q,W,X,eN]),eU=(0,i.useCallback)((e,t)=>{V({message:e,type:t})},[]),eI=(0,i.useCallback)(async(e,t,r)=>{if(s)try{var i,l;let a=(0,c.Xl)(s),n=(null===(i=s.user_metadata)||void 0===i?void 0:i.full_name)||(null===(l=s.user_metadata)||void 0===l?void 0:l.name)||"Unknown",{error:d}=await f.from("admin_logs").insert([{action:e,description:t,admin_id:a,admin_name:n,target_discord_id:r,created_at:new Date().toISOString()}]);if(d)throw d}catch(e){}},[s,f]),eL=(0,i.useCallback)(async(e,t)=>{if(!e){eU("Discord ID is required","error");return}if(g.some(t=>t.discord_id===e)){eU("User already exists","info");return}try{let{data:s,error:r}=await f.from("users").insert([{discord_id:e,username:t||null,revoked:!1,created_at:new Date().toISOString()}]).select();if(r)throw r;eU("User whitelisted successfully","success"),eI("whitelist","User ".concat(t||e," whitelisted"),e)}catch(e){eU("Failed to whitelist user","error")}},[g,f,eU,eI]),eE=(0,i.useCallback)(async(e,t)=>{try{let{error:s}=await f.from("users").update({revoked:t}).eq("discord_id",e);if(s)throw s;let r=t?"revoked":"whitelisted";eU("User ".concat(r," successfully"),"success"),eI(t?"revoke":"whitelist","".concat(t?"Revoke":"Whitelist"," action performed"),e),(null==y?void 0:y.discord_id)===e&&k(e=>e?{...e,revoked:t}:null)}catch(e){eU("Failed to update user status","error")}},[f,eU,eI,y]),eO=(0,i.useCallback)(async(e,t)=>{let s=new Date;s.setDate(s.getDate()+t);try{let{error:r}=await f.from("users").update({hub_trial:!0,trial_expiration:s.toISOString()}).eq("discord_id",e);if(r)throw r;eU("Trial extended by ".concat(t," days"),"success"),eI("trial","".concat(t," Day Trial action performed"),e),(null==y?void 0:y.discord_id)===e&&k(e=>e?{...e,hub_trial:!0,trial_expiration:s.toISOString()}:null)}catch(e){eU("Failed to update trial","error")}},[f,eU,eI,y]),eP=(0,i.useCallback)(async e=>{try{let{error:t}=await f.from("users").update({revoked:!1,trial_expiration:null}).eq("discord_id",e);if(t)throw t;eU("User converted to permanent whitelist","success"),eI("whitelist","Trial converted to permanent whitelist",e),(null==y?void 0:y.discord_id)===e&&k(e=>e?{...e,revoked:!1,trial_expiration:null}:null)}catch(e){eU("Failed to convert trial to permanent","error")}},[f,eU,eI,y]),ez=(0,i.useCallback)(async e=>{if(confirm("Are you sure you want to delete this user? This action cannot be undone."))try{let{error:t}=await f.from("users").delete().eq("discord_id",e);if(t)throw t;eU("User deleted successfully","success"),eI("delete","User deleted",e),(null==y?void 0:y.discord_id)===e&&(L(!1),k(null)),_(t=>{let s=new Set(t);return s.delete(e),s})}catch(e){eU("Failed to delete user","error")}},[f,eU,eI,y]),eF=(0,i.useCallback)(async()=>{if(0===N.size){eU("No users selected","info");return}if(confirm("Whitelist ".concat(N.size," selected users?")))try{let{error:e}=await f.from("users").update({revoked:!1}).in("discord_id",Array.from(N));if(e)throw e;eU("".concat(N.size," users whitelisted"),"success"),eI("bulk_whitelist","Bulk Whitelist action performed for ".concat(N.size," users")),_(new Set)}catch(e){eU("Failed to whitelist users","error")}},[N,f,eU,eI]),eR=(0,i.useCallback)(async()=>{if(0===N.size){eU("No users selected","info");return}if(confirm("Revoke access for ".concat(N.size," selected users?")))try{let{error:e}=await f.from("users").update({revoked:!0}).in("discord_id",Array.from(N));if(e)throw e;eU("".concat(N.size," users revoked"),"success"),eI("bulk_revoke","Bulk Revoke action performed for ".concat(N.size," users")),_(new Set)}catch(e){eU("Failed to revoke users","error")}},[N,f,eU,eI]),eq=(0,i.useCallback)(async()=>{if(0===N.size){eU("No users selected","info");return}if(!confirm("Add 7-day trial to ".concat(N.size," selected users?")))return;let e=new Date;e.setDate(e.getDate()+7);try{let{error:t}=await f.from("users").update({hub_trial:!0,trial_expiration:e.toISOString()}).in("discord_id",Array.from(N));if(t)throw t;eU("7-day trial added for ".concat(N.size," users"),"success"),eI("trial","Bulk trial assignment for ".concat(N.size," users")),_(new Set)}catch(e){eU("Failed to add trials","error")}},[N,f,eU,eI]),eM=(0,i.useCallback)(async()=>{if(0===N.size){eU("No users selected","info");return}if(confirm("DELETE ".concat(N.size," selected users? This action cannot be undone!")))try{let{error:e}=await f.from("users").delete().in("discord_id",Array.from(N));if(e)throw e;eU("".concat(N.size," users deleted"),"success"),eI("bulk_delete","Bulk Delete action performed for ".concat(N.size," users")),_(new Set)}catch(e){eU("Failed to delete users","error")}},[N,f,eU,eI]),eW=(0,i.useCallback)(e=>{_(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},[]),eB=(0,i.useCallback)(()=>{N.size===v.length?_(new Set):_(new Set(v.map(e=>e.discord_id)))},[N,v]),eX=(0,i.useCallback)(async e=>{let t=g.find(t=>t.discord_id===e);t&&(k(t),L(!0),await eT(e))},[g,eT]),eJ=(0,i.useCallback)(e=>e?new Date(e).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never",[]),eG=(0,i.useCallback)(e=>{if(!e)return"Never";let t=new Date(e),s=Math.floor((new Date().getTime()-t.getTime())/6e4),r=Math.floor(s/60),i=Math.floor(r/24);return s<1?"Just now":s<60?"".concat(s,"m ago"):r<24?"".concat(r,"h ago"):i<7?"".concat(i,"d ago"):eJ(e)},[eJ]),eV=(0,i.useCallback)(e=>{if(!e.hub_trial)return"N/A";if(!e.trial_expiration)return"TRIAL";let t=new Date(e.trial_expiration),s=new Date;if(!(t>s))return"EXPIRED";{let e=Math.ceil((t.getTime()-s.getTime())/864e5);return"TRIAL (".concat(e,"d)")}},[]),eZ=(0,i.useCallback)(e=>{let t=e.toLowerCase();if(t.includes("whitelist")||t.includes("access"))return"bg-green-500/20 text-green-400 border border-green-500/30";if(t.includes("revoke")||t.includes("revoked"))return"bg-red-500/20 text-red-400 border border-red-500/30";if(t.includes("trial"))return"bg-yellow-400/20 text-yellow-300 border border-yellow-400/30";if(t.includes("delete"))return"bg-red-600/20 text-red-300 border border-red-600/30";switch(t){case"whitelisted":case"online":return"bg-green-500/20 text-green-400 border border-green-500/30";case"revoked":return"bg-red-500/20 text-red-400 border border-red-500/30";default:return"bg-gray-500/20 text-gray-400 border border-gray-500/20"}},[]);(0,i.useCallback)((e,t)=>{},[]);let eH=(0,i.useCallback)(e=>{let t={};return e.forEach(e=>{t[e.page_path]||(t[e.page_path]={time:0,sessions:0}),t[e.page_path].time+=e.time_spent_seconds,t[e.page_path].sessions++}),Object.entries(t).sort((e,t)=>{let[,s]=e,[,r]=t;return r.time-s.time}).slice(0,ed)},[ed]),eY=(0,i.useCallback)(e=>{if(!e||!ee[e])return null;let t=Object.entries(ee[e]).map(e=>{let[t,s]=e;return{page:t,sessions:s.length,totalTime:s.reduce((e,t)=>e+t,0),avgTime:s.reduce((e,t)=>e+t,0)/s.length}}).filter(e=>e.totalTime/60>=ei);return t.sort((e,t)=>{switch(ea){case"sessions":return t.sessions-e.sessions;case"page":return e.page.localeCompare(t.page);default:return t.totalTime-e.totalTime}}),t},[ee,ei,ea]),eK=(0,i.useCallback)(()=>Z.filter(e=>{var t,s,r,i;return(!em||((null===(t=e.admin_name)||void 0===t?void 0:t.toLowerCase())||"").includes(em.toLowerCase()))&&(!eb||((null===(s=e.action)||void 0===s?void 0:s.toLowerCase())||"").includes(eb.toLowerCase()))&&(!eg||((null===(r=e.description)||void 0===r?void 0:r.toLowerCase())||"").includes(eg.toLowerCase()))&&(!ev||((null===(i=e.target_discord_id)||void 0===i?void 0:i.toLowerCase())||"").includes(ev.toLowerCase()))}),[Z,em,eb,eg,ev]);(0,i.useEffect)(()=>{eA()},[C,P,F,q,W,X]),(0,i.useEffect)(()=>{eC()},[eo,eh,eC]);let eQ={totalUsers:g.length,whitelistedUsers:g.filter(e=>!e.revoked).length,revokedUsers:g.filter(e=>e.revoked).length,trialUsers:g.filter(e=>e.hub_trial&&e.trial_expiration&&new Date(e.trial_expiration)>new Date).length,onlineUsers:A.size,totalLogins:g.reduce((e,t)=>e+(t.login_count||0),0),activeUsers:g.filter(e=>!!e.last_login&&new Date(e.last_login)>new Date(Date.now()-864e5)).length},e$={totalUsers:Object.keys(ee).length,totalSessions:Q.length,avgSessionTime:Q.length>0?Q.reduce((e,t)=>e+t.time_spent_seconds,0)/Q.length:0,uniquePages:new Set(Q.map(e=>e.page_path)).size},e0=e=>{if(!e||!ee[e])return{totalTime:0,totalSessions:0,uniquePages:0};let t=Object.entries(ee[e]),s=t.reduce((e,t)=>{let[,s]=t;return e+s.length},0);return{totalTime:t.reduce((e,t)=>{let[,s]=t;return e+s.reduce((e,t)=>e+t,0)},0),totalSessions:s,uniquePages:t.length}};return m?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-[#121212]",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#00c6ff]"})}):s&&e_()?(0,r.jsxs)("div",{className:"min-h-screen bg-[#121212] text-[#f0f0f0] p-4 md:p-8",children:[(0,r.jsxs)("div",{className:"max-w-[1600px] mx-auto bg-[rgba(30,30,30,0.9)] rounded-xl p-4 md:p-8 border border-white/5 shadow-2xl backdrop-blur-xl relative",children:[(0,r.jsx)(d.default,{href:"/",className:"inline-flex items-center text-[#00c6ff] border border-[#00c6ff] rounded-md px-4 py-2 text-sm font-semibold hover:bg-[#00c6ff]/10 transition-colors mb-4",children:"← Back"}),(0,r.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-[#00c6ff] text-center mb-6",children:"Admin Dashboard"}),(0,r.jsx)("div",{className:"mb-8 flex justify-center",children:(0,r.jsxs)(o,{children:[(0,r.jsx)(u,{value:"users",onClick:p,active:"users"===b,children:"User Management"}),(0,r.jsx)(u,{value:"analytics",onClick:p,active:"analytics"===b,children:"Analytics"})]})}),(0,r.jsx)(h,{value:"users",activeValue:b,children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[(0,r.jsx)("input",{type:"text",id:"newDiscordId",placeholder:"Enter Discord ID",className:"flex-1 p-3 bg-white/5 border border-white/20 rounded-lg text-white"}),(0,r.jsx)("input",{type:"text",id:"newUsername",placeholder:"Enter Username",className:"flex-1 p-3 bg-white/5 border border-white/20 rounded-lg text-white"}),(0,r.jsx)("button",{onClick:()=>{eL(document.getElementById("newDiscordId").value,document.getElementById("newUsername").value)},className:"bg-[#00c6ff] text-black font-bold py-3 px-6 rounded-lg hover:bg-[#00a9db] transition-colors",children:"Whitelist User"})]}),(0,r.jsx)("div",{className:"flex flex-wrap gap-4 mb-6",children:(0,r.jsx)("button",{onClick:()=>O(!E),className:"text-[#00c6ff] border border-[#00c6ff] px-4 py-2 rounded-lg hover:bg-[#00c6ff]/10 transition-colors",children:E?"Hide Advanced Filters":"Show Advanced Filters"})}),E&&(0,r.jsx)("div",{className:"bg-white/2 border border-white/5 rounded-xl p-4 mb-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("label",{className:"text-white/70",children:"Status"}),(0,r.jsxs)("select",{value:P,onChange:e=>z(e.target.value),className:"p-2 bg-[#2a2a2a] text-white border border-white/20 rounded-lg",children:[(0,r.jsx)("option",{value:"all",children:"All Users"}),(0,r.jsx)("option",{value:"whitelisted",children:"Whitelisted"}),(0,r.jsx)("option",{value:"revoked",children:"Revoked"}),(0,r.jsx)("option",{value:"trial",children:"On Trial"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("label",{className:"text-white/70",children:"Login Activity"}),(0,r.jsxs)("select",{value:F,onChange:e=>R(e.target.value),className:"p-2 bg-[#2a2a2a] text-white border border-white/20 rounded-lg",children:[(0,r.jsx)("option",{value:"all",children:"All Activity"}),(0,r.jsx)("option",{value:"active_24h",children:"Active 24h"}),(0,r.jsx)("option",{value:"active_7d",children:"Active 7d"}),(0,r.jsx)("option",{value:"active_30d",children:"Active 30d"}),(0,r.jsx)("option",{value:"never_logged",children:"Never Logged In"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("label",{className:"text-white/70",children:"Account Type"}),(0,r.jsxs)("select",{value:q,onChange:e=>M(e.target.value),className:"p-2 bg-[#2a2a2a] text-white border border-white/20 rounded-lg",children:[(0,r.jsx)("option",{value:"all",children:"All Types"}),(0,r.jsx)("option",{value:"admin",children:"Admins"}),(0,r.jsx)("option",{value:"regular",children:"Regular Users"}),(0,r.jsx)("option",{value:"trial",children:"Trial Users"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("label",{className:"text-white/70",children:"Date Range"}),(0,r.jsxs)("select",{value:W,onChange:e=>B(e.target.value),className:"p-2 bg-[#2a2a2a] text-white border border-white/20 rounded-lg",children:[(0,r.jsx)("option",{value:"all",children:"All Time"}),(0,r.jsx)("option",{value:"today",children:"Today"}),(0,r.jsx)("option",{value:"week",children:"This Week"}),(0,r.jsx)("option",{value:"month",children:"This Month"}),(0,r.jsx)("option",{value:"quarter",children:"This Quarter"})]})]})]})}),(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[(0,r.jsx)("input",{type:"text",value:C,onChange:e=>S(e.target.value),placeholder:"Search Discord ID, Username, or Email",className:"flex-1 p-3 bg-white/5 border border-white/20 rounded-lg text-white"}),(0,r.jsxs)("select",{value:X,onChange:e=>J(e.target.value),className:"p-3 bg-[#2a2a2a] text-white border border-white/20 rounded-lg",children:[(0,r.jsx)("option",{value:"last_login",children:"Sort: Last Login"}),(0,r.jsx)("option",{value:"login_count",children:"Sort: Login Count"}),(0,r.jsx)("option",{value:"username",children:"Sort: Username"}),(0,r.jsx)("option",{value:"created_at",children:"Sort: Date Added"}),(0,r.jsx)("option",{value:"trial_expiration",children:"Sort: Trial Expiration"})]}),(0,r.jsx)("button",{onClick:ek,disabled:D,className:"bg-[#2a2a2a] text-white border border-white/20 px-6 py-3 rounded-lg hover:bg-white/10 transition-colors disabled:opacity-50",children:D?(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white/90 rounded-full animate-spin mr-2"}),"Loading..."]}):"Refresh"})]}),N.size>0&&(0,r.jsxs)("div",{className:"bg-white/2 border border-white/5 rounded-xl p-4 mb-6",children:[(0,r.jsxs)("h3",{className:"text-[#00c6ff] text-lg font-semibold mb-4",children:["Bulk Actions (",N.size," selected)"]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,r.jsx)("button",{onClick:eF,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Whitelist Selected"}),(0,r.jsx)("button",{onClick:eR,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Revoke Selected"}),(0,r.jsx)("button",{onClick:eq,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors",children:"Add 7 Day Trial"}),(0,r.jsx)("button",{onClick:eM,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Delete Selected"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"bg-white/4 border border-white/5 rounded-xl p-4 flex items-center gap-4",children:[(0,r.jsx)("div",{className:"text-2xl text-[#00c6ff]",children:"\uD83D\uDC65"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xs uppercase tracking-wider text-[#00c6ff] mb-1",children:"Total Users"}),(0,r.jsx)("p",{className:"text-xl font-bold",children:eQ.totalUsers})]})]}),(0,r.jsxs)("div",{className:"bg-white/4 border border-white/5 rounded-xl p-4 flex items-center gap-4",children:[(0,r.jsx)("div",{className:"text-2xl text-[#00c6ff]",children:"⚡"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xs uppercase tracking-wider text-[#00c6ff] mb-1",children:"Online Now"}),(0,r.jsx)("p",{className:"text-xl font-bold",children:eQ.onlineUsers})]})]}),(0,r.jsxs)("div",{className:"bg-white/4 border border-white/5 rounded-xl p-4 flex items-center gap-4",children:[(0,r.jsx)("div",{className:"text-2xl text-[#00c6ff]",children:"\uD83D\uDCC8"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xs uppercase tracking-wider text-[#00c6ff] mb-1",children:"Total Logins"}),(0,r.jsx)("p",{className:"text-xl font-bold",children:eQ.totalLogins})]})]}),(0,r.jsxs)("div",{className:"bg-white/4 border border-white/5 rounded-xl p-4 flex items-center gap-4",children:[(0,r.jsx)("div",{className:"text-2xl text-[#00c6ff]",children:"\uD83D\uDD12"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xs uppercase tracking-wider text-[#00c6ff] mb-1",children:"Revoked Users"}),(0,r.jsx)("p",{className:"text-xl font-bold",children:eQ.revokedUsers})]})]}),(0,r.jsxs)("div",{className:"bg-white/4 border border-white/5 rounded-xl p-4 flex items-center gap-4",children:[(0,r.jsx)("div",{className:"text-2xl text-[#00c6ff]",children:"\uD83C\uDFAF"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xs uppercase tracking-wider text-[#00c6ff] mb-1",children:"Trial Users"}),(0,r.jsx)("p",{className:"text-xl font-bold",children:eQ.trialUsers})]})]}),(0,r.jsxs)("div",{className:"bg-white/4 border border-white/5 rounded-xl p-4 flex items-center gap-4",children:[(0,r.jsx)("div",{className:"text-2xl text-[#00c6ff]",children:"⏰"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xs uppercase tracking-wider text-[#00c6ff] mb-1",children:"Active Last 24h"}),(0,r.jsx)("p",{className:"text-xl font-bold",children:eQ.activeUsers})]})]})]}),(0,r.jsx)("div",{className:"bg-white/1 border border-white/5 rounded-xl overflow-hidden",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-white/3 sticky top-0 z-10",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"p-4 text-left",children:(0,r.jsx)("input",{type:"checkbox",checked:N.size===v.length&&v.length>0,onChange:eB,className:"w-4 h-4 rounded bg-white/10 border-white/30 text-[#00c6ff] focus:ring-[#00c6ff]/30"})}),(0,r.jsx)("th",{className:"p-4 text-left text-[#00c6ff] font-semibold",children:"Discord ID"}),(0,r.jsx)("th",{className:"p-4 text-left text-[#00c6ff] font-semibold",children:"Username"}),(0,r.jsx)("th",{className:"p-4 text-left text-[#00c6ff] font-semibold",children:"Added"}),(0,r.jsx)("th",{className:"p-4 text-left text-[#00c6ff] font-semibold",children:"Last Login"}),(0,r.jsx)("th",{className:"p-4 text-left text-[#00c6ff] font-semibold",children:"Login Count"}),(0,r.jsx)("th",{className:"p-4 text-left text-[#00c6ff] font-semibold",children:"Status"}),(0,r.jsx)("th",{className:"p-4 text-left text-[#00c6ff] font-semibold",children:"Trial"}),(0,r.jsx)("th",{className:"p-4 text-left text-[#00c6ff] font-semibold",children:"Session"}),(0,r.jsx)("th",{className:"p-4 text-left text-[#00c6ff] font-semibold",children:"Actions"})]})}),(0,r.jsxs)("tbody",{children:[v.map(e=>(0,r.jsxs)("tr",{className:"border-b border-white/5 hover:bg-white/5 cursor-pointer transition-colors",onClick:()=>eX(e.discord_id),children:[(0,r.jsx)("td",{className:"p-4",onClick:e=>e.stopPropagation(),children:(0,r.jsx)("input",{type:"checkbox",checked:N.has(e.discord_id),onChange:()=>eW(e.discord_id),className:"w-4 h-4 rounded bg-white/10 border-white/30 text-[#00c6ff] focus:ring-[#00c6ff]/30"})}),(0,r.jsxs)("td",{className:"p-4",children:[e.discord_id,eN.includes(e.discord_id)&&(0,r.jsx)("span",{className:"ml-2 px-2 py-0.5 text-xs font-bold bg-gradient-to-r from-[#ffd700] to-[#ffed4e] text-black rounded-md",children:"ADMIN"})]}),(0,r.jsx)("td",{className:"p-4",children:e.username||"N/A"}),(0,r.jsx)("td",{className:"p-4",children:eJ(e.created_at)}),(0,r.jsx)("td",{className:"p-4",children:e.last_login?eJ(e.last_login):"Never"}),(0,r.jsx)("td",{className:"p-4",children:e.login_count||0}),(0,r.jsx)("td",{className:"p-4",children:(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold uppercase ".concat(e.revoked?eZ("revoked"):eZ("whitelisted")),children:e.revoked?"REVOKED":"ACCESS"})}),(0,r.jsx)("td",{className:"p-4",children:e.hub_trial?e.trial_expiration&&new Date(e.trial_expiration)>new Date?(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold uppercase whitespace-nowrap ".concat(eZ("trial")),children:eV(e)}):(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold uppercase ".concat(eZ("revoked")),children:"EXPIRED"}):"N/A"}),(0,r.jsx)("td",{className:"p-4",children:(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold uppercase ".concat(A.has(e.discord_id)?eZ("online"):eZ("offline")),children:A.has(e.discord_id)?"ONLINE":"OFFLINE"})}),(0,r.jsx)("td",{className:"p-4",onClick:e=>e.stopPropagation(),children:(0,r.jsxs)("div",{className:"relative inline-block text-left",children:[(0,r.jsx)("button",{className:"text-white hover:bg-white/10 rounded-md p-2",onClick:e=>{e.stopPropagation();let t=e.currentTarget.nextElementSibling;t&&t.classList.toggle("hidden")},children:"☰"}),(0,r.jsx)("div",{className:"hidden absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-[#2a2a2a] shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:(0,r.jsxs)("div",{className:"py-1",children:[(0,r.jsx)("button",{className:"block w-full px-4 py-2 text-left text-sm hover:bg-white/10",onClick:t=>{var s;t.stopPropagation(),eE(e.discord_id,!e.revoked),null===(s=t.currentTarget.closest(".hidden"))||void 0===s||s.classList.add("hidden")},children:e.revoked?"Whitelist":"Revoke"}),(0,r.jsx)("button",{className:"block w-full px-4 py-2 text-left text-sm text-red-400 hover:bg-white/10",onClick:t=>{var s;t.stopPropagation(),ez(e.discord_id),null===(s=t.currentTarget.closest(".hidden"))||void 0===s||s.classList.add("hidden")},children:"Delete"})]})})]})})]},e.discord_id)),0===v.length&&(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:10,className:"p-8 text-center text-white/50",children:"No users found matching your filters"})})]})]})})})]})}),(0,r.jsx)(h,{value:"analytics",activeValue:b,children:(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-xl p-4 text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-[#00c6ff] mb-1",children:e$.totalUsers}),(0,r.jsx)("div",{className:"text-xs text-white/70 uppercase tracking-wider",children:"Active Users"})]}),(0,r.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-xl p-4 text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-[#00c6ff] mb-1",children:e$.totalSessions}),(0,r.jsx)("div",{className:"text-xs text-white/70 uppercase tracking-wider",children:"Total Sessions"})]}),(0,r.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-xl p-4 text-center",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-[#00c6ff] mb-1",children:[(e$.avgSessionTime/60).toFixed(1),"m"]}),(0,r.jsx)("div",{className:"text-xs text-white/70 uppercase tracking-wider",children:"Avg Session Time"})]}),(0,r.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-xl p-4 text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-[#00c6ff] mb-1",children:e$.uniquePages}),(0,r.jsx)("div",{className:"text-xs text-white/70 uppercase tracking-wider",children:"Unique Pages"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white/[0.05] border border-white/[0.1] rounded-xl overflow-hidden",children:[(0,r.jsx)("div",{className:"bg-[#00c6ff]/10 border-b border-[#00c6ff]/20 p-4",children:(0,r.jsx)("h2",{className:"text-xl font-semibold text-[#00c6ff]",children:"Top Pages by Time Spent"})}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("div",{className:"flex items-center gap-4 mb-4",children:(0,r.jsxs)("select",{value:ed,onChange:e=>ec(Number(e.target.value)),className:"bg-[#1c1c1c] border border-white/20 text-white p-2 rounded-lg",children:[(0,r.jsx)("option",{value:10,children:"Top 10"}),(0,r.jsx)("option",{value:15,children:"Top 15"}),(0,r.jsx)("option",{value:25,children:"Top 25"})]})}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-white/[0.03] border-b border-white/10",children:[(0,r.jsx)("th",{className:"p-3 text-left text-[#00c6ff] font-semibold",children:"Rank"}),(0,r.jsx)("th",{className:"p-3 text-left text-[#00c6ff] font-semibold",children:"Page"}),(0,r.jsx)("th",{className:"p-3 text-left text-[#00c6ff] font-semibold",children:"Total Time"}),(0,r.jsx)("th",{className:"p-3 text-left text-[#00c6ff] font-semibold",children:"Sessions"})]})}),(0,r.jsxs)("tbody",{children:[eH(Q).map((e,t)=>{let[s,i]=e;return(0,r.jsxs)("tr",{className:"border-b border-white/5 hover:bg-white/[0.03]",children:[(0,r.jsxs)("td",{className:"p-3 font-semibold",children:["#",t+1]}),(0,r.jsx)("td",{className:"p-3",children:(0,r.jsx)("span",{className:"bg-white/5 px-2 py-1 rounded text-sm font-mono",children:s})}),(0,r.jsxs)("td",{className:"p-3 font-semibold",children:[(i.time/60).toFixed(1)," min"]}),(0,r.jsxs)("td",{className:"p-3",children:[i.sessions," sessions"]})]},s)}),0===eH(Q).length&&(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:4,className:"p-6 text-center text-white/50",children:"No page data available"})})]})]})})]})]}),(0,r.jsxs)("div",{className:"bg-white/[0.05] border border-white/[0.1] rounded-xl overflow-hidden",children:[(0,r.jsx)("div",{className:"bg-[#00c6ff]/10 border-b border-[#00c6ff]/20 p-4",children:(0,r.jsx)("h2",{className:"text-xl font-semibold text-[#00c6ff]",children:"User Page Analytics"})}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[(0,r.jsxs)("select",{value:es,onChange:e=>er(e.target.value),className:"flex-1 bg-[#1c1c1c] border border-white/20 text-white p-2 rounded-lg",children:[(0,r.jsx)("option",{value:"",children:"Select a user..."}),Object.keys(ee).sort().map(e=>(0,r.jsx)("option",{value:e,children:e},e))]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("label",{className:"text-white/70",children:"Min time:"}),(0,r.jsx)("input",{type:"number",value:ei,onChange:e=>el(Number(e.target.value)),min:0,className:"w-20 bg-[#1c1c1c] border border-white/20 text-white p-2 rounded-lg"}),(0,r.jsx)("span",{className:"text-white/70",children:"minutes"})]}),(0,r.jsxs)("select",{value:ea,onChange:e=>en(e.target.value),className:"bg-[#1c1c1c] border border-white/20 text-white p-2 rounded-lg",children:[(0,r.jsx)("option",{value:"time",children:"Sort by Time"}),(0,r.jsx)("option",{value:"sessions",children:"Sort by Sessions"}),(0,r.jsx)("option",{value:"page",children:"Sort by Page"})]})]}),es&&(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[(0,r.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-lg p-3 text-center",children:[(0,r.jsxs)("div",{className:"text-xl font-bold text-[#00c6ff] mb-1",children:[(e0(es).totalTime/60).toFixed(1),"m"]}),(0,r.jsx)("div",{className:"text-xs text-white/70",children:"Total Time"})]}),(0,r.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-lg p-3 text-center",children:[(0,r.jsx)("div",{className:"text-xl font-bold text-[#00c6ff] mb-1",children:e0(es).totalSessions}),(0,r.jsx)("div",{className:"text-xs text-white/70",children:"Total Sessions"})]}),(0,r.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-lg p-3 text-center",children:[(0,r.jsx)("div",{className:"text-xl font-bold text-[#00c6ff] mb-1",children:e0(es).uniquePages}),(0,r.jsx)("div",{className:"text-xs text-white/70",children:"Unique Pages"})]})]})}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-white/[0.03] border-b border-white/10",children:[(0,r.jsx)("th",{className:"p-3 text-left text-[#00c6ff] font-semibold",children:"Page"}),(0,r.jsx)("th",{className:"p-3 text-left text-[#00c6ff] font-semibold",children:"Sessions"}),(0,r.jsx)("th",{className:"p-3 text-left text-[#00c6ff] font-semibold",children:"Total Time"}),(0,r.jsx)("th",{className:"p-3 text-left text-[#00c6ff] font-semibold",children:"Avg Time"})]})}),(0,r.jsxs)("tbody",{children:[es&&(null===(e=eY(es))||void 0===e?void 0:e.map(e=>(0,r.jsxs)("tr",{className:"border-b border-white/5 hover:bg-white/[0.03]",children:[(0,r.jsx)("td",{className:"p-3",children:(0,r.jsx)("span",{className:"bg-white/5 px-2 py-1 rounded text-sm font-mono",children:e.page})}),(0,r.jsx)("td",{className:"p-3",children:e.sessions}),(0,r.jsxs)("td",{className:"p-3 font-semibold",children:[(e.totalTime/60).toFixed(1)," min"]}),(0,r.jsxs)("td",{className:"p-3",children:[(e.avgTime/60).toFixed(1)," min"]})]},e.page))),!es&&(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:4,className:"p-6 text-center text-white/50",children:"Select a user to view their page analytics"})}),es&&(null===(t=eY(es))||void 0===t?void 0:t.length)===0&&(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:4,className:"p-6 text-center text-white/50",children:"No data matches the current filters"})})]})]})})]})]})]}),(0,r.jsxs)("div",{className:"bg-white/[0.05] border border-white/[0.1] rounded-xl overflow-hidden",children:[(0,r.jsx)("div",{className:"bg-[#00c6ff]/10 border-b border-[#00c6ff]/20 p-4",children:(0,r.jsx)("h2",{className:"text-xl font-semibold text-[#00c6ff]",children:"Admin Audit Logs"})}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex flex-wrap gap-3 mb-4",children:[(0,r.jsx)("input",{value:em,onChange:e=>ef(e.target.value),placeholder:"Admin name",className:"flex-1 min-w-[200px] bg-[#1c1c1c] border border-white/20 text-white p-2 rounded-lg"}),(0,r.jsx)("input",{value:eb,onChange:e=>ep(e.target.value),placeholder:"Action",className:"flex-1 min-w-[200px] bg-[#1c1c1c] border border-white/20 text-white p-2 rounded-lg"}),(0,r.jsx)("input",{value:eg,onChange:e=>ew(e.target.value),placeholder:"Description",className:"flex-1 min-w-[200px] bg-[#1c1c1c] border border-white/20 text-white p-2 rounded-lg"}),(0,r.jsx)("input",{value:ev,onChange:e=>ej(e.target.value),placeholder:"Target Username",className:"flex-1 min-w-[200px] bg-[#1c1c1c] border border-white/20 text-white p-2 rounded-lg"}),(0,r.jsxs)("select",{value:eh,onChange:e=>ex(Number(e.target.value)),className:"bg-[#1c1c1c] border border-white/20 text-white p-2 rounded-lg",children:[(0,r.jsx)("option",{value:15,children:"15 per page"}),(0,r.jsx)("option",{value:25,children:"25 per page"}),(0,r.jsx)("option",{value:50,children:"50 per page"})]})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-white/[0.03] border-b border-white/10",children:[(0,r.jsx)("th",{className:"p-3 text-left text-[#00c6ff] font-semibold",children:"Admin"}),(0,r.jsx)("th",{className:"p-3 text-left text-[#00c6ff] font-semibold",children:"Action"}),(0,r.jsx)("th",{className:"p-3 text-left text-[#00c6ff] font-semibold",children:"Description"}),(0,r.jsx)("th",{className:"p-3 text-left text-[#00c6ff] font-semibold",children:"Target"}),(0,r.jsx)("th",{className:"p-3 text-left text-[#00c6ff] font-semibold",children:"Time"})]})}),(0,r.jsxs)("tbody",{children:[eK().map(e=>{let t=g.find(t=>t.discord_id===e.target_discord_id);return(0,r.jsxs)("tr",{className:"border-b border-white/5 hover:bg-white/[0.03]",children:[(0,r.jsx)("td",{className:"p-3 font-semibold",children:e.admin_name}),(0,r.jsx)("td",{className:"p-3",children:(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold uppercase ".concat(eZ(e.action||"")),children:e.action})}),(0,r.jsx)("td",{className:"p-3",children:e.description}),(0,r.jsx)("td",{className:"p-3",children:(null==t?void 0:t.username)||e.target_discord_id||"N/A"}),(0,r.jsx)("td",{className:"p-3",children:e.created_at?eJ(e.created_at):"N/A"})]},e.id)}),0===eK().length&&(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:5,className:"p-6 text-center text-white/50",children:"No logs match the current filters"})})]})]})}),(0,r.jsxs)("div",{className:"flex justify-center items-center gap-4 mt-4",children:[(0,r.jsx)("button",{onClick:()=>eu(e=>Math.max(0,e-1)),disabled:0===eo,className:"px-4 py-2 bg-[#1c1c1c] border border-white/20 text-white rounded-lg disabled:opacity-50",children:"← Previous"}),(0,r.jsxs)("span",{className:"text-white/70",children:["Page ",eo+1]}),(0,r.jsx)("button",{onClick:()=>eu(e=>e+1),disabled:eK().length<eh,className:"px-4 py-2 bg-[#1c1c1c] border border-white/20 text-white rounded-lg disabled:opacity-50",children:"Next →"})]})]})]})]})})]}),I&&y&&(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex justify-end",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>L(!1)}),(0,r.jsxs)("div",{className:"relative w-full max-w-md bg-[#141414] border-l border-white/10 overflow-y-auto",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-white/10 flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-[#00c6ff]",children:"User Details"}),(0,r.jsx)("button",{onClick:()=>L(!1),className:"text-white/70 hover:text-white text-xl",children:"✕"})]}),(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white/[0.03] border border-white/[0.08] rounded-xl p-4 space-y-3",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-[#00c6ff] mb-2",children:"User Information"}),(0,r.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-white/5",children:[(0,r.jsx)("span",{className:"text-white/70",children:"Discord ID:"}),(0,r.jsx)("span",{className:"font-semibold",children:y.discord_id})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-white/5",children:[(0,r.jsx)("span",{className:"text-white/70",children:"Username:"}),(0,r.jsx)("span",{className:"font-semibold",children:y.username||"N/A"})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-white/5",children:[(0,r.jsx)("span",{className:"text-white/70",children:"Status:"}),(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold uppercase ".concat(y.revoked?eZ("revoked"):eZ("whitelisted")),children:y.revoked?"REVOKED":"ACCESS"})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-white/5",children:[(0,r.jsx)("span",{className:"text-white/70",children:"Account Type:"}),(0,r.jsx)("span",{className:"font-semibold",children:eN.includes(y.discord_id)?(0,r.jsx)("span",{className:"px-2 py-0.5 text-xs font-bold bg-gradient-to-r from-[#ffd700] to-[#ffed4e] text-black rounded-md",children:"ADMIN"}):"Regular User"})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-white/5",children:[(0,r.jsx)("span",{className:"text-white/70",children:"Created:"}),(0,r.jsx)("span",{className:"font-semibold",children:eJ(y.created_at)})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-white/5",children:[(0,r.jsx)("span",{className:"text-white/70",children:"Last Login:"}),(0,r.jsx)("span",{className:"font-semibold",children:y.last_login?eJ(y.last_login):"Never"})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-white/5",children:[(0,r.jsx)("span",{className:"text-white/70",children:"Login Count:"}),(0,r.jsx)("span",{className:"font-semibold",children:y.login_count||0})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-white/5",children:[(0,r.jsx)("span",{className:"text-white/70",children:"Trial Status:"}),(0,r.jsx)("span",{children:y.hub_trial?y.trial_expiration&&new Date(y.trial_expiration)>new Date?(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold uppercase ".concat(eZ("trial")),children:eV(y)}):(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold uppercase ".concat(eZ("revoked")),children:"EXPIRED"}):"N/A"})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-white/5",children:[(0,r.jsx)("span",{className:"text-white/70",children:"Session:"}),(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold uppercase ".concat(A.has(y.discord_id)?eZ("online"):eZ("offline")),children:A.has(y.discord_id)?"ONLINE":"OFFLINE"})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center py-2",children:[(0,r.jsx)("span",{className:"text-white/70",children:"Blueprints:"}),(0,r.jsxs)("span",{className:"font-semibold",children:[Y.length," Selected"]})]})]}),(0,r.jsxs)("div",{className:"bg-white/[0.02] border border-white/[0.05] rounded-xl p-4 space-y-3",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-[#00c6ff] mb-2",children:"Quick Actions"}),(0,r.jsx)("button",{onClick:()=>eE(y.discord_id,!y.revoked),className:"w-full py-3 px-4 rounded-lg font-semibold ".concat(y.revoked?"bg-green-600 text-white hover:bg-green-700":"bg-red-600 text-white hover:bg-red-700"," transition-colors"),children:y.revoked?"Whitelist User":"Revoke Access"}),y.hub_trial&&y.trial_expiration&&new Date(y.trial_expiration)>new Date&&(0,r.jsx)("button",{onClick:()=>eP(y.discord_id),className:"w-full py-3 px-4 bg-gradient-to-r from-[#ffd700] to-[#ffed4e] text-black font-semibold rounded-lg hover:shadow-lg transition-all",children:"Convert Trial to Permanent"}),(0,r.jsx)("button",{onClick:()=>eO(y.discord_id,7),className:"w-full py-3 px-4 bg-amber-500 text-white font-semibold rounded-lg hover:bg-amber-600 transition-colors",children:"Add 7 Day Trial"}),(0,r.jsx)("button",{onClick:()=>eO(y.discord_id,30),className:"w-full py-3 px-4 bg-orange-500 text-white font-semibold rounded-lg hover:bg-orange-600 transition-colors",children:"Add 30 Day Trial"}),(0,r.jsx)("button",{onClick:()=>{let e=prompt("Enter number of days for trial:");e&&!isNaN(Number(e))&&Number(e)>0&&eO(y.discord_id,Number(e))},className:"w-full py-3 px-4 bg-[#00c6ff] text-black font-semibold rounded-lg hover:bg-[#00a9db] transition-colors",children:"Custom Trial Duration"}),(0,r.jsx)("button",{onClick:()=>ez(y.discord_id),className:"w-full py-3 px-4 bg-red-600 text-white font-semibold rounded-lg hover:bg-red-700 transition-colors",children:"Delete User"}),(0,r.jsx)("button",{onClick:()=>{alert("User has ".concat(Y.length," blueprints selected:\n\n").concat(Y.join("\n")))},className:"w-full py-3 px-4 bg-white/10 text-white font-semibold rounded-lg hover:bg-white/20 transition-colors",children:"Show Blueprints"})]}),(0,r.jsxs)("div",{className:"bg-white/[0.02] border border-white/[0.05] rounded-xl p-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-[#00c6ff] mb-4",children:"Audit Log"}),(0,r.jsxs)("div",{className:"max-h-[300px] overflow-y-auto space-y-3",children:[Z.filter(e=>e.target_discord_id===y.discord_id).slice(0,10).map(e=>{var t,s,i,l,a,n;return(null===(t=e.action)||void 0===t?void 0:t.toLowerCase().includes("whitelist"))||(null===(s=e.action)||void 0===s?void 0:s.toLowerCase().includes("revoke"))||null===(i=e.action)||void 0===i||i.toLowerCase().includes("trial"),(0,r.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-black/20 rounded-lg",children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full mt-2 ".concat((null===(l=e.action)||void 0===l?void 0:l.toLowerCase().includes("whitelist"))?"bg-green-500":(null===(a=e.action)||void 0===a?void 0:a.toLowerCase().includes("revoke"))?"bg-red-500":(null===(n=e.action)||void 0===n?void 0:n.toLowerCase().includes("trial"))?"bg-yellow-500":"bg-blue-500")}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("div",{className:"font-semibold",children:e.description}),(0,r.jsxs)("div",{className:"text-sm text-white/70",children:["by ",e.admin_name]}),(0,r.jsx)("div",{className:"text-xs text-white/50 mt-1",children:e.created_at?eG(e.created_at):"N/A"})]})]},e.id)}),0===Z.filter(e=>e.target_discord_id===y.discord_id).length&&(0,r.jsx)("div",{className:"text-center py-4 text-white/50",children:"No audit logs for this user"})]})]})]})]})]}),G&&(0,r.jsx)(x,{message:G.message,type:G.type,onClose:()=>V(null)})]}):null}},4603:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return c},a:function(){return d}});var r=s(7437),i=s(2265),l=s(8933),a=s(3448);let n=(0,i.createContext)({user:null,session:null,loading:!0,hasAccess:!1,isTrialActive:!1,signInWithDiscord:async()=>{},signOut:async()=>{},refreshUserData:async()=>{}}),d=()=>{let e=(0,i.useContext)(n);if(!e)throw Error("useAuth must be used within an AuthProvider");return e};function c(e){let{children:t}=e,[s,d]=(0,i.useState)({user:null,session:null,loading:!0,hasAccess:!1,isTrialActive:!1}),c=(0,l.e)(),o=async e=>{let t=(0,a.Xl)(e);if(!t)return{hasAccess:!1,isTrialActive:!1};try{let{data:e,error:s}=await c.from("users").select("revoked, hub_trial, trial_expiration").eq("discord_id",t).single();if(s||!e)return{hasAccess:!1,isTrialActive:!1};let r=(0,a.$1)(e);return{hasAccess:(0,a.Bi)(e),isTrialActive:r}}catch(e){return{hasAccess:!1,isTrialActive:!1}}},u=async()=>{if(!s.user)return;let{hasAccess:e,isTrialActive:t}=await o(s.user);d(s=>({...s,hasAccess:e,isTrialActive:t}))},h=async()=>{try{let{error:e}=await c.auth.signInWithOAuth({provider:"discord",options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}});if(e)throw e}catch(e){}},x=async()=>{try{let{error:e}=await c.auth.signOut();if(e)throw e;d({user:null,session:null,loading:!1,hasAccess:!1,isTrialActive:!1})}catch(e){}};return(0,i.useEffect)(()=>{(async()=>{try{let{data:{session:t},error:s}=await c.auth.getSession();if(s){d(e=>({...e,loading:!1}));return}if(null==t?void 0:t.user){var e;let{hasAccess:s,isTrialActive:r}=await o(t.user);d({user:t.user,session:t,loading:!1,hasAccess:s,isTrialActive:r});let i=(0,a.Xl)(t.user),l=(null===(e=t.user.user_metadata)||void 0===e?void 0:e.full_name)||"Discord User";i&&await c.rpc("upsert_user_login",{target_discord_id:i,user_name:l})}else d(e=>({...e,loading:!1}))}catch(e){d(e=>({...e,loading:!1}))}})();let{data:{subscription:e}}=c.auth.onAuthStateChange(async(e,t)=>{if("SIGNED_IN"===e&&(null==t?void 0:t.user)){let{hasAccess:e,isTrialActive:s}=await o(t.user);d({user:t.user,session:t,loading:!1,hasAccess:e,isTrialActive:s})}else"SIGNED_OUT"===e&&d({user:null,session:null,loading:!1,hasAccess:!1,isTrialActive:!1})});return()=>e.unsubscribe()},[]),(0,i.useEffect)(()=>{if(!s.user)return;let e=(0,a.Xl)(s.user);if(!e)return;let t=c.channel("user-access-changes").on("postgres_changes",{event:"UPDATE",schema:"public",table:"users",filter:"discord_id=eq.".concat(e)},async e=>{await u()}).subscribe();return()=>{c.removeChannel(t)}},[s.user]),(0,r.jsx)(n.Provider,{value:{...s,signInWithDiscord:h,signOut:x,refreshUserData:u},children:t})}},2495:function(e,t,s){"use strict";s.d(t,{j:function(){return d}});var r=s(2265),i=s(9376),l=s(8933),a=s(4603),n=s(3448);function d(){let{user:e}=(0,a.a)(),t=(0,i.usePathname)(),s=(0,l.e)(),d=(0,r.useRef)(null),c=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(!e)return;let r=(0,n.Xl)(e),i=(0,n.Ms)(e);if(!r)return;let l=async()=>{if(d.current)try{await s.from("page_sessions").update({exit_time:new Date().toISOString(),is_active:!1}).eq("id",d.current)}catch(e){}},a=async()=>{if(d.current&&"visible"===document.visibilityState)try{await s.from("page_sessions").update({is_active:!0}).eq("id",d.current)}catch(e){}};(async e=>{try{d.current&&c.current&&await s.from("page_sessions").update({exit_time:new Date().toISOString(),is_active:!1}).eq("id",d.current);let{data:t,error:l}=await s.from("page_sessions").insert([{discord_id:r,username:i,page_path:e,enter_time:new Date().toISOString(),is_active:!0}]).select("id").single();l||(d.current=(null==t?void 0:t.id)||null,c.current=e)}catch(e){}})(t);let o=()=>{"hidden"===document.visibilityState?d.current&&Promise.resolve(s.from("page_sessions").update({is_active:!1}).eq("id",d.current)).then(()=>{}).catch(console.error):"visible"===document.visibilityState&&a()},u=()=>{l()};document.addEventListener("visibilitychange",o),window.addEventListener("beforeunload",u);let h=setInterval(a,3e4);return()=>{document.removeEventListener("visibilitychange",o),window.removeEventListener("beforeunload",u),clearInterval(h),l()}},[e,t]),(0,r.useEffect)(()=>{if(!e||!d.current)return;let r=(0,n.Xl)(e),i=(0,n.Ms)(e);if(!r)return;let l=async()=>{d.current&&await s.from("page_sessions").update({exit_time:new Date().toISOString(),is_active:!1}).eq("id",d.current);let{data:e,error:l}=await s.from("page_sessions").insert([{discord_id:r,username:i,page_path:t,enter_time:new Date().toISOString(),is_active:!0}]).select("id").single();!l&&e&&(d.current=e.id,c.current=t)};c.current!==t&&l()},[t,e])}},8933:function(e,t,s){"use strict";s.d(t,{e:function(){return i}});var r=s(9924);let i=()=>(0,r.AY)("https://dsexkdjxmhgqahrlkvax.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRzZXhrZGp4bWhncWFocmxrdmF4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg0ODAxNTAsImV4cCI6MjA2NDA1NjE1MH0.RW_ROpcNUNZaK9xGH2OFwHBSmFsGrLj-yi3LWCPBCvA")},3448:function(e,t,s){"use strict";s.d(t,{$1:function(){return c},Bi:function(){return o},E$:function(){return d},Ms:function(){return n},Xl:function(){return a},cn:function(){return l}});var r=s(1994),i=s(3335);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,i.m6)((0,r.W)(t))}function a(e){var t,s;return(null==e?void 0:null===(t=e.user_metadata)||void 0===t?void 0:t.provider_id)||(null==e?void 0:null===(s=e.user_metadata)||void 0===s?void 0:s.sub)||null}function n(e){var t,s,r;return(null==e?void 0:null===(t=e.user_metadata)||void 0===t?void 0:t.full_name)||(null==e?void 0:null===(s=e.user_metadata)||void 0===s?void 0:s.name)||(null==e?void 0:null===(r=e.user_metadata)||void 0===r?void 0:r.user_name)||"Discord User"}function d(e){var t;return(null==e?void 0:null===(t=e.user_metadata)||void 0===t?void 0:t.avatar_url)||"https://cdn.discordapp.com/embed/avatars/0.png"}function c(e){if(!(null==e?void 0:e.hub_trial)||!(null==e?void 0:e.trial_expiration))return!1;let t=new Date;return new Date(e.trial_expiration)>t}function o(e){return!!e&&(!1===e.revoked||c(e))}}},function(e){e.O(0,[454,924,972,971,117,744],function(){return e(e.s=2020)}),_N_E=e.O()}]);