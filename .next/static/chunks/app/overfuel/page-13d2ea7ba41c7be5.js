(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[137],{1762:function(e,t,i){Promise.resolve().then(i.bind(i,3985))},9376:function(e,t,i){"use strict";var r=i(5475);i.o(r,"usePathname")&&i.d(t,{usePathname:function(){return r.usePathname}}),i.o(r,"useRouter")&&i.d(t,{useRouter:function(){return r.useRouter}})},3985:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return u}});var r=i(7437),n=i(2265),s=i(2495),a=i(4603);let l=[{position:1,name:"Monti Gas Station",type:"⛽"},{position:2,name:"Meaux Harbour - Crabapple Bay",type:"⚓"},{position:3,name:"\xc9toupe Gas Station (Parcel 4)",type:"⛽"},{position:4,name:"VW Dealer",type:"⛽"},{position:5,name:"St Philippe Gas Station",type:"⛽"},{position:6,name:"St Philippe - Charlet Bay",type:"⚓"},{position:7,name:"St Philippe - Birchwood Bay",type:"⚓"},{position:8,name:"Airport",type:"\uD83D\uDEEB"},{position:9,name:"Lamentin Gas Station",type:"⛽"},{position:10,name:"St Pierre Gas Station",type:"⛽"},{position:11,name:"Montingac Farm",type:"\uD83D\uDC0F"},{position:12,name:"Morton Bay",type:"⚓"}],o=[{value:12,label:"Total Stations"},{value:8,label:"Fuel Stations"},{value:3,label:"Harbor Points"},{value:1,label:"Airport Hub"}],c=e=>{let{station:t,onClose:i}=e;return t?(0,r.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:i,children:(0,r.jsxs)("div",{className:"bg-[#1e1e1e]/95 backdrop-blur-xl border border-white/10 rounded-2xl p-6 max-w-lg w-full shadow-2xl",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-2xl font-bold text-[#00c6ff]",children:t.name}),(0,r.jsx)("button",{onClick:i,className:"text-white/70 hover:text-white text-2xl transition-colors",children:"\xd7"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("div",{className:"text-4xl text-center my-4",children:t.type}),(0,r.jsxs)("p",{className:"text-white/80",children:["Position: ",t.position]})]}),(0,r.jsx)("div",{className:"h-[200px] bg-white/5 rounded-lg flex items-center justify-center mb-4",children:(0,r.jsx)("p",{className:"text-white/50",children:"Map image will be available soon"})}),(0,r.jsx)("button",{onClick:i,className:"w-full py-2 px-4 bg-gradient-to-r from-[#00c6ff] to-[#0072ff] text-white font-semibold rounded-lg hover:shadow-lg transition-all",children:"Close"})]})}):null};function u(){(0,s.j)();let{hasAccess:e,loading:t}=(0,a.a)(),[i,u]=(0,n.useState)(null);return((0,n.useEffect)(()=>{t||e||(window.location.href="/")},[e,t]),t)?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-[#0a0a0b] to-[#1a1a1b]",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#00c6ff]"})}):e?(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-[#0a0a0b] to-[#1a1a1b] text-[#f0f0f0]",children:[(0,r.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-8 flex flex-col min-h-screen",children:[(0,r.jsx)("header",{className:"text-center py-8 border-b border-white/8 mb-8",children:(0,r.jsx)("h1",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-[#00c6ff] to-[#0072ff] inline-block text-transparent bg-clip-text mb-2",children:"OverFuel+"})}),(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:o.map((e,t)=>(0,r.jsxs)("div",{className:"bg-white/[0.02] border border-white/[0.08] rounded-xl p-6 text-center transition-all hover:bg-[#00c6ff]/5 hover:border-[#00c6ff]/20 hover:-translate-y-0.5 backdrop-blur-lg",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-[#00c6ff] mb-2",children:e.value}),(0,r.jsx)("div",{className:"text-sm text-white/70 uppercase tracking-wider",children:e.label})]},t))}),(0,r.jsxs)("div",{className:"bg-white/[0.02] border border-white/[0.08] rounded-xl overflow-hidden backdrop-blur-lg flex-1",children:[(0,r.jsx)("div",{className:"bg-[#00c6ff]/10 border-b border-[#00c6ff]/20 p-5",children:(0,r.jsx)("h2",{className:"text-xl font-semibold text-[#00c6ff]",children:"Station Directory"})}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-white/[0.03] border-b-2 border-white/10",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"p-4 md:p-5 text-left font-semibold text-sm text-[#00c6ff] uppercase tracking-wider",children:"Position"}),(0,r.jsx)("th",{className:"p-4 md:p-5 text-left font-semibold text-sm text-[#00c6ff] uppercase tracking-wider",children:"Station"}),(0,r.jsx)("th",{className:"p-4 md:p-5 text-left font-semibold text-sm text-[#00c6ff] uppercase tracking-wider",children:"Type"})]})}),(0,r.jsx)("tbody",{children:l.map(e=>(0,r.jsxs)("tr",{className:"border-b border-white/5 last:border-b-0 hover:bg-white/[0.02] transition-colors cursor-pointer",onClick:()=>u(e),children:[(0,r.jsx)("td",{className:"p-4 md:p-5 font-semibold text-[#00c6ff] w-[80px] md:w-auto",children:e.position}),(0,r.jsx)("td",{className:"p-4 md:p-5 text-white/95 font-medium",children:e.name}),(0,r.jsx)("td",{className:"p-4 md:p-5 text-2xl text-center w-[80px] md:w-auto",children:e.type})]},e.position))})]})})]})]}),i&&(0,r.jsx)(c,{station:i,onClose:()=>u(null)})]}):null}},4603:function(e,t,i){"use strict";i.d(t,{AuthProvider:function(){return c},a:function(){return o}});var r=i(7437),n=i(2265),s=i(8933),a=i(3448);let l=(0,n.createContext)({user:null,session:null,loading:!0,hasAccess:!1,isTrialActive:!1,signInWithDiscord:async()=>{},signOut:async()=>{},refreshUserData:async()=>{}}),o=()=>{let e=(0,n.useContext)(l);if(!e)throw Error("useAuth must be used within an AuthProvider");return e};function c(e){let{children:t}=e,[i,o]=(0,n.useState)({user:null,session:null,loading:!0,hasAccess:!1,isTrialActive:!1}),c=(0,s.e)(),u=async e=>{let t=(0,a.Xl)(e);if(!t)return{hasAccess:!1,isTrialActive:!1};try{let{data:e,error:i}=await c.from("users").select("revoked, hub_trial, trial_expiration").eq("discord_id",t).single();if(i||!e)return{hasAccess:!1,isTrialActive:!1};let r=(0,a.$1)(e);return{hasAccess:(0,a.Bi)(e),isTrialActive:r}}catch(e){return{hasAccess:!1,isTrialActive:!1}}},d=async()=>{if(!i.user)return;let{hasAccess:e,isTrialActive:t}=await u(i.user);o(i=>({...i,hasAccess:e,isTrialActive:t}))},m=async()=>{try{let{error:e}=await c.auth.signInWithOAuth({provider:"discord",options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}});if(e)throw e}catch(e){}},f=async()=>{try{let{error:e}=await c.auth.signOut();if(e)throw e;o({user:null,session:null,loading:!1,hasAccess:!1,isTrialActive:!1})}catch(e){}};return(0,n.useEffect)(()=>{(async()=>{try{let{data:{session:t},error:i}=await c.auth.getSession();if(i){o(e=>({...e,loading:!1}));return}if(null==t?void 0:t.user){var e;let{hasAccess:i,isTrialActive:r}=await u(t.user);o({user:t.user,session:t,loading:!1,hasAccess:i,isTrialActive:r});let n=(0,a.Xl)(t.user),s=(null===(e=t.user.user_metadata)||void 0===e?void 0:e.full_name)||"Discord User";n&&await c.rpc("upsert_user_login",{target_discord_id:n,user_name:s})}else o(e=>({...e,loading:!1}))}catch(e){o(e=>({...e,loading:!1}))}})();let{data:{subscription:e}}=c.auth.onAuthStateChange(async(e,t)=>{if("SIGNED_IN"===e&&(null==t?void 0:t.user)){let{hasAccess:e,isTrialActive:i}=await u(t.user);o({user:t.user,session:t,loading:!1,hasAccess:e,isTrialActive:i})}else"SIGNED_OUT"===e&&o({user:null,session:null,loading:!1,hasAccess:!1,isTrialActive:!1})});return()=>e.unsubscribe()},[]),(0,n.useEffect)(()=>{if(!i.user)return;let e=(0,a.Xl)(i.user);if(!e)return;let t=c.channel("user-access-changes").on("postgres_changes",{event:"UPDATE",schema:"public",table:"users",filter:"discord_id=eq.".concat(e)},async e=>{await d()}).subscribe();return()=>{c.removeChannel(t)}},[i.user]),(0,r.jsx)(l.Provider,{value:{...i,signInWithDiscord:m,signOut:f,refreshUserData:d},children:t})}},2495:function(e,t,i){"use strict";i.d(t,{j:function(){return o}});var r=i(2265),n=i(9376),s=i(8933),a=i(4603),l=i(3448);function o(){let{user:e}=(0,a.a)(),t=(0,n.usePathname)(),i=(0,s.e)(),o=(0,r.useRef)(null),c=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(!e)return;let r=(0,l.Xl)(e),n=(0,l.Ms)(e);if(!r)return;let s=async()=>{if(o.current)try{await i.from("page_sessions").update({exit_time:new Date().toISOString(),is_active:!1}).eq("id",o.current)}catch(e){}},a=async()=>{if(o.current&&"visible"===document.visibilityState)try{await i.from("page_sessions").update({is_active:!0}).eq("id",o.current)}catch(e){}};(async e=>{try{o.current&&c.current&&await i.from("page_sessions").update({exit_time:new Date().toISOString(),is_active:!1}).eq("id",o.current);let{data:t,error:s}=await i.from("page_sessions").insert([{discord_id:r,username:n,page_path:e,enter_time:new Date().toISOString(),is_active:!0}]).select("id").single();s||(o.current=(null==t?void 0:t.id)||null,c.current=e)}catch(e){}})(t);let u=()=>{"hidden"===document.visibilityState?o.current&&Promise.resolve(i.from("page_sessions").update({is_active:!1}).eq("id",o.current)).then(()=>{}).catch(console.error):"visible"===document.visibilityState&&a()},d=()=>{s()};document.addEventListener("visibilitychange",u),window.addEventListener("beforeunload",d);let m=setInterval(a,3e4);return()=>{document.removeEventListener("visibilitychange",u),window.removeEventListener("beforeunload",d),clearInterval(m),s()}},[e,t]),(0,r.useEffect)(()=>{if(!e||!o.current)return;let r=(0,l.Xl)(e),n=(0,l.Ms)(e);if(!r)return;let s=async()=>{o.current&&await i.from("page_sessions").update({exit_time:new Date().toISOString(),is_active:!1}).eq("id",o.current);let{data:e,error:s}=await i.from("page_sessions").insert([{discord_id:r,username:n,page_path:t,enter_time:new Date().toISOString(),is_active:!0}]).select("id").single();!s&&e&&(o.current=e.id,c.current=t)};c.current!==t&&s()},[t,e])}},8933:function(e,t,i){"use strict";i.d(t,{e:function(){return n}});var r=i(9924);let n=()=>(0,r.AY)("https://dsexkdjxmhgqahrlkvax.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRzZXhrZGp4bWhncWFocmxrdmF4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg0ODAxNTAsImV4cCI6MjA2NDA1NjE1MH0.RW_ROpcNUNZaK9xGH2OFwHBSmFsGrLj-yi3LWCPBCvA")},3448:function(e,t,i){"use strict";i.d(t,{$1:function(){return c},Bi:function(){return u},E$:function(){return o},Ms:function(){return l},Xl:function(){return a},cn:function(){return s}});var r=i(1994),n=i(3335);function s(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return(0,n.m6)((0,r.W)(t))}function a(e){var t,i;return(null==e?void 0:null===(t=e.user_metadata)||void 0===t?void 0:t.provider_id)||(null==e?void 0:null===(i=e.user_metadata)||void 0===i?void 0:i.sub)||null}function l(e){var t,i,r;return(null==e?void 0:null===(t=e.user_metadata)||void 0===t?void 0:t.full_name)||(null==e?void 0:null===(i=e.user_metadata)||void 0===i?void 0:i.name)||(null==e?void 0:null===(r=e.user_metadata)||void 0===r?void 0:r.user_name)||"Discord User"}function o(e){var t;return(null==e?void 0:null===(t=e.user_metadata)||void 0===t?void 0:t.avatar_url)||"https://cdn.discordapp.com/embed/avatars/0.png"}function c(e){if(!(null==e?void 0:e.hub_trial)||!(null==e?void 0:e.trial_expiration))return!1;let t=new Date;return new Date(e.trial_expiration)>t}function u(e){return!!e&&(!1===e.revoked||c(e))}}},function(e){e.O(0,[454,924,971,117,744],function(){return e(e.s=1762)}),_N_E=e.O()}]);